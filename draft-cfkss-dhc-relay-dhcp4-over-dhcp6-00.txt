



Dynamic Host Configuration Working Group                    M. Siodelski
Internet-Draft                                                       ISC
Updates: 3315 (if approved)                               March 19, 2013
Intended status: Standards Track
Expires: September 20, 2013


                   Relay DHCPv4 messages over DHCPv6
               draft-cfkss-dhc-relay-dhcp4-over-dhcp6-00

Abstract

   This document describes the mechanism to provision the DHCPv4 clients
   by leveraging DHCPv6 relays.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on September 20, 2013.

Copyright Notice

   Copyright (c) 2013 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents



Siodelski              Expires September 20, 2013               [Page 1]

Internet-Draft          Relay DHCPv4 over DHCPv6              March 2013



   1.  Requirements Language . . . . . . . . . . . . . . . . . . . .   2
   2.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   3.  Use Cases . . . . . . . . . . . . . . . . . . . . . . . . . .   2
   4.  Security Considerations . . . . . . . . . . . . . . . . . . .   4
   5.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   4
   6.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .   4
   7.  Informative References  . . . . . . . . . . . . . . . . . . .   5
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . .   5

1.  Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [RFC2119].

2.  Introduction

   During the transition from IPv4 to IPv6 the dual stack networks are
   common.  Many architectures propose delivery mechanisms based on
   IPv6-only operator's networks while still offering IPv4 connectivity.
   In many cases, the host being configured with DHCPv4 protocol is
   separated from the DHCPv4 server by the IPv6 only network segment.
   Existing protocols do not allow for DHCPv4 traffic to traverse IPv6
   network.

   This document describes extensions to DHCPv6 protocol to allow
   transmission of DHCPv4 traffic via DHCPv6 enabled network.

3.  Use Cases

   To leverage existing deployed architecture and not require additional
   components to be deployed in the network, existing DHCPv6 relays are
   extended with the new functionality.

   The assumption that DHCPv4 packets can be encapsulated by the DHCPv6
   RELAY-FORWARD and RELAY-REPLY messages is fundamental for the
   extensions described in this document.  Thus, if the DHCPv4 client is
   separated from the DHCPv4 server by the IPv6 network segment it is
   required that DHCPv6 traffic is carried through this segment and that
   at least one relay agent resides on the route between the DHCP4
   client and server.

   It is assumed that there is a DHCPv6 relay deployed on each link the
   clients are connected to.

    +--------------+   v4
    | DHCP4 client |--------+     Unified    Relayed



Siodelski              Expires September 20, 2013               [Page 2]

Internet-Draft          Relay DHCPv4 over DHCPv6              March 2013


    +--------------+        |    +-------+  v4 and v6 +---------------+
                            +----| Relay |------------| DHCPv6 server |
    +--------------+   v6   |    +-------+ Relay-forw +---------------+
    | DHCP6 client |--------+               (DHCPv6)
    +--------------+

       Figure 1: Network topology with DHCPv6 server handling DHCPv4
                                 messages

   The Figure 1 shows the sample network topology where the traffic from
   both DHCPv4 and DHCPv6 clients is directed to the same DHCP6 server.
   The unified relay agent conveys both v4 or v6 messages in RELAY-FORW
   message described in section 7.1 of RFC 3315 [RFC3315], but in two
   different options.  The DHCPv6 messages are conveyed in
   OPTION_RELAY_MSG as described in the RFC 3315 [RFC3315] while the v4
   messages are conveyed in the new option OPTION_RELAY_MSG4 defined in
   this document.  This guarantees that relay agents and servers may
   easily differentiate the DHCPv4 and DHCPv6 traffic by simply looking
   at the type of the option being carried in the RELAY-FORW message.

   Once the server has processed the message it sends back the response
   to the relay agent in the RELAY-REPL message described in section 7.2
   of RFC 3315 [RFC3315].  Server uses OPTION_RELAY_MSG4 to relay
   responses to DHCPv4 requests.

   The topology presented above requires that not only is DHCP6 server
   capable to process DHCP6, but also DHCP4 traffic.  Such hybrid
   implementations are common and in many cases can be created with a
   minimal effort if the particular code comprises shared libraries with
   DHCP4 and DHCP6 packets processing logic.  The exact way how the
   server processes DHCPv4 traffic received over DHCPv6 is outside of
   scope for this document.

   Another desired use case is to process the v4 and v6 messages on two
   distinct servers - DHCP6 server processing only v6 messages and the
   DHCP4 server processing only v4 messagess.  The corresponding network
   topology has been shown on the Figure 2.

                                                +---------------+
   +---------------+  v4             +-----(4)--| DHCPv6 server |
   | DHCPv4 client |----+            |          +---------------+
   +---------------+    |       +----+--+       +---------------+
                        +-(1)---| Relay |--(2)--| DHCPv4 server |
                                +----+--+       +---------------+
   +---------------+  v6             |
   | DHCPv6 client |------(3)--------+
   +---------------+




Siodelski              Expires September 20, 2013               [Page 3]

Internet-Draft          Relay DHCPv4 over DHCPv6              March 2013


   1. normal DHCPv4 traffic
   2. DHCPv4 packets encapsulated in RELAY-FORW/RELAY-REPL message in DHCPv6
   3. normal DHCPv6 traffic
   4. DHCPv6 packets encapsulated in RELAY-FORW/RELAY-REPL message in DHCPv6

       Figure 2: Network topology with DHCPv6 server handling DHCPv4
                                 messages

   The v4 message is initiated by the DHCP4 client and is relayed by the
   Relay in the same way as in the previous example.  However, in this
   case the v6 and v4 messages are directed to different destinations.
   The v4 messages are relayed to the DHCP4 server using IPv4.
   Therefore, the following conditions MUST be met if the implementation
   supports this use case.

   o  The relay agents MUST be configurable so as respective
      destinations can be specified for v4 and v6 traffic.  It MUST be
      possible to configure different server destinations for each
      protocol family.

   o  The relay agent adjacent to the DHCP4 server MUST be able to relay
      incoming DHCP4o6 messages using IPv4.

   o  The relay agent adjacent to the DHCP4 server MUST be able to
      receive relayed DHCP4 traffic from the server and relay it using
      DHCPv6 RELAY-REPL as described above.

   The former of the use cases described in this chapter MUST be
   supported by all implementations conforming to this specification.
   The support for the latter use case is optional.

4.  Security Considerations

   TBD

5.  IANA Considerations

   TBD

6.  Acknowledgements

   TBD









Siodelski              Expires September 20, 2013               [Page 4]

Internet-Draft          Relay DHCPv4 over DHCPv6              March 2013


7.  Informative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

   [RFC3315]  Droms, R., Bound, J., Volz, B., Lemon, T., Perkins, C.,
              and M. Carney, "Dynamic Host Configuration Protocol for
              IPv6 (DHCPv6)", RFC 3315, July 2003.

Author's Address

   Marcin Siodelski
   950 Charter Street
   Redwood City, CA  94063
   USA

   Phone: +1 650 423 1431
   Email: msiodelski@gmail.com
































Siodelski              Expires September 20, 2013               [Page 5]
